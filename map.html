<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Players Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
  <style>html,body,#map{height:100%;margin:0;padding:0}</style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
  <script>
    const map = L.map('map').setView([39.5, -98.35], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom:19}).addTo(map);

    fetch('players.geojson')
      .then(r => r.json())
      .then(data => {
        const markers = L.markerClusterGroup();
        L.geoJSON(data, {
          pointToLayer: (feature, latlng) => {
            const props = feature.properties || {};
            const m = L.marker(latlng);
            let popup = `<b>${props.name || ''}</b><br/>`;
            popup += `${props.position || ''} — ${props.team_status || ''}<br/>`;
            popup += `${props.college || ''}<br/>${props.college_address || ''}<br/>${props.city || ''}, ${props.state || ''}`;
            m.bindPopup(popup);
            return m;
          }
        }).addTo(markers);
        map.addLayer(markers);
      })
      .catch(err => { console.error(err); alert('Failed to load players.geojson — run generate_players_geojson.py first and serve this directory over HTTP.'); });
  </script>
</body>
</html>
